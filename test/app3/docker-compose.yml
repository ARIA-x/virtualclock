version: '3.8'

services:

  pair1ball:
    build:
      context: ./pair1/ball/
    tty: true
    depends_on:
      - pair1player
      - vcserver
    volumes:
      - ../../:/aria-dsl2/
    networks:
      - local_bus

  pair1player:
    build:
      context: ./pair1/player/
    tty: true
    depends_on:
      - vcserver
    volumes:
      - ../../:/aria-dsl2/
    networks:
      - local_bus

  vcserver:
    build:
      context: ../../VirtualClock/vcserver
    tty: true
    volumes:
      - ../../:/aria-dsl2/
    depends_on:
      - broker
    networks:
      - local_bus

  broker:
    image: eclipse-mosquitto:1.6
    volumes:
      - ../../mosquitto.conf:/mosquitto/config/mosquitto.conf
    ports:
      - "1883:1883"
    networks:
      - local_bus
      - public_bus

networks:
  local_bus:
  public_bus:
    name: docker.aria
    external: true
